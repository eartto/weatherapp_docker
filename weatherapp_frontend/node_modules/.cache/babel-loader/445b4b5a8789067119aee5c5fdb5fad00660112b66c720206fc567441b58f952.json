{"ast":null,"code":"import{createSlice}from'@reduxjs/toolkit';import weatherHistoryService from'../services/weatherHistoryService';const initialState=[];const weatherHistorySlice=createSlice({name:'weatherHistory',initialState,reducers:{setHistory:(state,action)=>{const history=action.payload;state=history.reverse();return state;},addHistory:(state,action)=>{const city=action.payload;state.push(city);},removeHistory:state=>{weatherHistoryService.remove();state.pop();}}});export const fetchWeatherHistory=()=>{return async dispatch=>{const weatherHistory=await weatherHistoryService.getAll();dispatch(setHistory(weatherHistory));};};export const addWeatherHistory=city=>{return async dispatch=>{const cities=await weatherHistoryService.getAll();if(!cities.some(c=>c.city===city)){const newCity=await weatherHistoryService.create(city);dispatch(setHistory(cities));dispatch(addHistory(newCity));dispatch(removeHistory());}};};export const{setHistory,addHistory,removeHistory}=weatherHistorySlice.actions;const weatherHistoryReducer=weatherHistorySlice.reducer;export default weatherHistoryReducer;","map":{"version":3,"names":["createSlice","weatherHistoryService","initialState","weatherHistorySlice","name","reducers","setHistory","state","action","history","payload","reverse","addHistory","city","push","removeHistory","remove","pop","fetchWeatherHistory","dispatch","weatherHistory","getAll","addWeatherHistory","cities","some","c","newCity","create","actions","weatherHistoryReducer","reducer"],"sources":["/home/eartto/weatherapp/weatherapp_frontend/src/reducers/weatherHistoryReducer.ts"],"sourcesContent":["import { createSlice, Dispatch } from '@reduxjs/toolkit';\nimport weatherHistoryService from '../services/weatherHistoryService';\nimport { weatherHistory } from '../@types/weatherHistory';\n\nconst initialState = [] as weatherHistory[];\n\nconst weatherHistorySlice = createSlice({\n  name: 'weatherHistory',\n  initialState,\n  reducers: {\n    setHistory: (state, action) => {\n      const history = action.payload;\n      state = history.reverse();\n      return state;\n    },\n    addHistory: (state, action) => {\n      const city = action.payload;\n      state.push(city);\n    },\n    removeHistory: (state) => {\n      weatherHistoryService.remove();\n      state.pop();\n    },\n  },\n});\n\nexport const fetchWeatherHistory = () => {\n  return async (dispatch: Dispatch) => {\n    const weatherHistory = await weatherHistoryService.getAll();\n    dispatch(setHistory(weatherHistory));\n  };\n};\n\nexport const addWeatherHistory = (city: string) => {\n  return async (dispatch: Dispatch) => {\n    const cities = (await weatherHistoryService.getAll()) as weatherHistory[];\n    if (!cities.some((c) => c.city === city)) {\n      const newCity = await weatherHistoryService.create(city);\n      dispatch(setHistory(cities));\n      dispatch(addHistory(newCity));\n      dispatch(removeHistory());\n    }\n  };\n};\n\nexport const { setHistory, addHistory, removeHistory } =\n  weatherHistorySlice.actions;\n\nconst weatherHistoryReducer = weatherHistorySlice.reducer;\n\nexport default weatherHistoryReducer;\n"],"mappings":"AAAA,OAASA,WAAW,KAAkB,kBAAkB,CACxD,MAAO,CAAAC,qBAAqB,KAAM,mCAAmC,CAGrE,KAAM,CAAAC,YAAY,CAAG,EAAsB,CAE3C,KAAM,CAAAC,mBAAmB,CAAGH,WAAW,CAAC,CACtCI,IAAI,CAAE,gBAAgB,CACtBF,YAAY,CACZG,QAAQ,CAAE,CACRC,UAAU,CAAEA,CAACC,KAAK,CAAEC,MAAM,GAAK,CAC7B,KAAM,CAAAC,OAAO,CAAGD,MAAM,CAACE,OAAO,CAC9BH,KAAK,CAAGE,OAAO,CAACE,OAAO,CAAC,CAAC,CACzB,MAAO,CAAAJ,KAAK,CACd,CAAC,CACDK,UAAU,CAAEA,CAACL,KAAK,CAAEC,MAAM,GAAK,CAC7B,KAAM,CAAAK,IAAI,CAAGL,MAAM,CAACE,OAAO,CAC3BH,KAAK,CAACO,IAAI,CAACD,IAAI,CAAC,CAClB,CAAC,CACDE,aAAa,CAAGR,KAAK,EAAK,CACxBN,qBAAqB,CAACe,MAAM,CAAC,CAAC,CAC9BT,KAAK,CAACU,GAAG,CAAC,CAAC,CACb,CACF,CACF,CAAC,CAAC,CAEF,MAAO,MAAM,CAAAC,mBAAmB,CAAGA,CAAA,GAAM,CACvC,MAAO,MAAO,CAAAC,QAAkB,EAAK,CACnC,KAAM,CAAAC,cAAc,CAAG,KAAM,CAAAnB,qBAAqB,CAACoB,MAAM,CAAC,CAAC,CAC3DF,QAAQ,CAACb,UAAU,CAACc,cAAc,CAAC,CAAC,CACtC,CAAC,CACH,CAAC,CAED,MAAO,MAAM,CAAAE,iBAAiB,CAAIT,IAAY,EAAK,CACjD,MAAO,MAAO,CAAAM,QAAkB,EAAK,CACnC,KAAM,CAAAI,MAAM,CAAI,KAAM,CAAAtB,qBAAqB,CAACoB,MAAM,CAAC,CAAsB,CACzE,GAAI,CAACE,MAAM,CAACC,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACZ,IAAI,GAAKA,IAAI,CAAC,CAAE,CACxC,KAAM,CAAAa,OAAO,CAAG,KAAM,CAAAzB,qBAAqB,CAAC0B,MAAM,CAACd,IAAI,CAAC,CACxDM,QAAQ,CAACb,UAAU,CAACiB,MAAM,CAAC,CAAC,CAC5BJ,QAAQ,CAACP,UAAU,CAACc,OAAO,CAAC,CAAC,CAC7BP,QAAQ,CAACJ,aAAa,CAAC,CAAC,CAAC,CAC3B,CACF,CAAC,CACH,CAAC,CAED,MAAO,MAAM,CAAET,UAAU,CAAEM,UAAU,CAAEG,aAAc,CAAC,CACpDZ,mBAAmB,CAACyB,OAAO,CAE7B,KAAM,CAAAC,qBAAqB,CAAG1B,mBAAmB,CAAC2B,OAAO,CAEzD,cAAe,CAAAD,qBAAqB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}