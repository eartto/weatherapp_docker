{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport weatherHistoryService from '../services/weatherHistoryService';\nconst initialState = [];\nconst weatherHistorySlice = createSlice({\n  name: 'weatherHistory',\n  initialState,\n  reducers: {\n    setHistory: (state, action) => {\n      const history = action.payload;\n      state = history.reverse();\n      return state;\n    },\n    addHistory: (state, action) => {\n      const city = action.payload;\n      state.push(city);\n    },\n    removeHistory: state => {\n      weatherHistoryService.remove();\n      state.pop();\n    }\n  }\n});\nexport const fetchWeatherHistory = () => {\n  return async dispatch => {\n    const weatherHistory = await weatherHistoryService.getAll();\n    dispatch(setHistory(weatherHistory));\n  };\n};\nexport const addWeatherHistory = city => {\n  return async dispatch => {\n    const cities = await weatherHistoryService.getAll();\n    if (!cities.some(c => c.city === city)) {\n      const newCity = await weatherHistoryService.create(city);\n      dispatch(setHistory(cities));\n      dispatch(addHistory(newCity));\n      dispatch(removeHistory());\n    }\n  };\n};\nexport const {\n  setHistory,\n  addHistory,\n  removeHistory\n} = weatherHistorySlice.actions;\nconst weatherHistoryReducer = weatherHistorySlice.reducer;\nexport default weatherHistoryReducer;","map":{"version":3,"names":["createSlice","weatherHistoryService","initialState","weatherHistorySlice","name","reducers","setHistory","state","action","history","payload","reverse","addHistory","city","push","removeHistory","remove","pop","fetchWeatherHistory","dispatch","weatherHistory","getAll","addWeatherHistory","cities","some","c","newCity","create","actions","weatherHistoryReducer","reducer"],"sources":["/home/eartto/weatherapp/weatherapp_frontend/src/reducers/weatherHistoryReducer.ts"],"sourcesContent":["import { createSlice, Dispatch } from '@reduxjs/toolkit';\nimport weatherHistoryService from '../services/weatherHistoryService';\nimport { weatherHistory } from '../@types/weatherHistory';\n\nconst initialState = [] as weatherHistory[];\n\nconst weatherHistorySlice = createSlice({\n  name: 'weatherHistory',\n  initialState,\n  reducers: {\n    setHistory: (state, action) => {\n      const history = action.payload;\n      state = history.reverse();\n      return state;\n    },\n    addHistory: (state, action) => {\n      const city = action.payload;\n      state.push(city);\n    },\n    removeHistory: (state) => {\n      weatherHistoryService.remove();\n      state.pop();\n    },\n  },\n});\n\nexport const fetchWeatherHistory = () => {\n  return async (dispatch: Dispatch) => {\n    const weatherHistory = await weatherHistoryService.getAll();\n    dispatch(setHistory(weatherHistory));\n  };\n};\n\nexport const addWeatherHistory = (city: string) => {\n  return async (dispatch: Dispatch) => {\n    const cities = (await weatherHistoryService.getAll()) as weatherHistory[];\n    if (!cities.some((c) => c.city === city)) {\n      const newCity = await weatherHistoryService.create(city);\n      dispatch(setHistory(cities));\n      dispatch(addHistory(newCity));\n      dispatch(removeHistory());\n    }\n  };\n};\n\nexport const { setHistory, addHistory, removeHistory } =\n  weatherHistorySlice.actions;\n\nconst weatherHistoryReducer = weatherHistorySlice.reducer;\n\nexport default weatherHistoryReducer;\n"],"mappings":"AAAA,SAASA,WAAW,QAAkB,kBAAkB;AACxD,OAAOC,qBAAqB,MAAM,mCAAmC;AAGrE,MAAMC,YAAY,GAAG,EAAsB;AAE3C,MAAMC,mBAAmB,GAAGH,WAAW,CAAC;EACtCI,IAAI,EAAE,gBAAgB;EACtBF,YAAY;EACZG,QAAQ,EAAE;IACRC,UAAU,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC7B,MAAMC,OAAO,GAAGD,MAAM,CAACE,OAAO;MAC9BH,KAAK,GAAGE,OAAO,CAACE,OAAO,CAAC,CAAC;MACzB,OAAOJ,KAAK;IACd,CAAC;IACDK,UAAU,EAAEA,CAACL,KAAK,EAAEC,MAAM,KAAK;MAC7B,MAAMK,IAAI,GAAGL,MAAM,CAACE,OAAO;MAC3BH,KAAK,CAACO,IAAI,CAACD,IAAI,CAAC;IAClB,CAAC;IACDE,aAAa,EAAGR,KAAK,IAAK;MACxBN,qBAAqB,CAACe,MAAM,CAAC,CAAC;MAC9BT,KAAK,CAACU,GAAG,CAAC,CAAC;IACb;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;EACvC,OAAO,MAAOC,QAAkB,IAAK;IACnC,MAAMC,cAAc,GAAG,MAAMnB,qBAAqB,CAACoB,MAAM,CAAC,CAAC;IAC3DF,QAAQ,CAACb,UAAU,CAACc,cAAc,CAAC,CAAC;EACtC,CAAC;AACH,CAAC;AAED,OAAO,MAAME,iBAAiB,GAAIT,IAAY,IAAK;EACjD,OAAO,MAAOM,QAAkB,IAAK;IACnC,MAAMI,MAAM,GAAI,MAAMtB,qBAAqB,CAACoB,MAAM,CAAC,CAAsB;IACzE,IAAI,CAACE,MAAM,CAACC,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACZ,IAAI,KAAKA,IAAI,CAAC,EAAE;MACxC,MAAMa,OAAO,GAAG,MAAMzB,qBAAqB,CAAC0B,MAAM,CAACd,IAAI,CAAC;MACxDM,QAAQ,CAACb,UAAU,CAACiB,MAAM,CAAC,CAAC;MAC5BJ,QAAQ,CAACP,UAAU,CAACc,OAAO,CAAC,CAAC;MAC7BP,QAAQ,CAACJ,aAAa,CAAC,CAAC,CAAC;IAC3B;EACF,CAAC;AACH,CAAC;AAED,OAAO,MAAM;EAAET,UAAU;EAAEM,UAAU;EAAEG;AAAc,CAAC,GACpDZ,mBAAmB,CAACyB,OAAO;AAE7B,MAAMC,qBAAqB,GAAG1B,mBAAmB,CAAC2B,OAAO;AAEzD,eAAeD,qBAAqB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}